<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">

<link rel="stylesheet" href="./css/global/_import.css">

<!-- Link Ícones | https://cdnjs.com/libraries/font-awesome | https://fontawesome.com/ -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
    integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />



<style>
    /* 
Padronização
Usar o prefixo: (my-divulgacao_eventos-s1-). 
Colocar primeiro o prefixo (my-divulgacao_eventos-s1-), depois as classes do bootstrap 
Isso ajuda na hora de diferenciar as classes criadas pela equipe de desenvolvimento e as classes já predefinidas do bootstrap
*/

    /* Divulgação - Eventos */
    .my-divulgacao_eventos-s1-eventos {
        display: inline-block;
        position: relative;
    }

    .my-divulgacao_eventos-s1-eventos::after {
        content: "";
        display: block;
        width: 30px;
        height: 3px;
        margin: 2px 0px;
        background-color: var(--cor-verdeDestaque);
        position: absolute;
        left: 0;
        border-radius: 20px;
    }



    /* Btn Salvar Alterações */
    .my-divulgacao_eventos-s1-btnSalvarAlterações {
        width: 100%;
        background-color: var(--cor-verdeEscuro);
        color: var(--cor-branco);
        box-shadow: var(--sombra-preta);
        padding: 5px;
        border-radius: 10px;
    }

    .my-divulgacao_eventos-s1-btnSalvarAlterações:hover {
        opacity: 90%;
    }



    /* Imagem */
    .my-divulgacao_eventos-s1-imagem {
        width: 100%;
        height: 150px;
        object-fit: cover;
    }



    /* Btn Ver Eventos */
    .my-divulgacao_eventos-s1-btnVerEventos {
        width: 45%;
        background-color: var(--cor-verdeEscuro);
        color: var(--cor-branco);
        box-shadow: var(--sombra-preta);
        padding: 5px 10px;
        border-radius: 10px;
    }

    .my-divulgacao_eventos-s1-btnVerEventos:hover {
        opacity: 90%;
    }



    /* Index */
    .my-divulgacao_eventos-s1-index {
        color: var(--cor-cinza);
        font-weight: 500;
    }
</style>


<div class="container my-5">

    <!-- Divulgação - Eventos -->
    <h5 class="my-divulgacao_eventos-s1-eventos mb-4">Eventos</h5>

    <!-- Botões -->
    <div>
        <button type="button" class="btn btn-success" onclick="addCard()">Adicionar Card</button>
        <button type="button" class="btn btn-secondary" onclick="openEditModal()">Editar Card</button>
        <button type="button" class="btn btn-danger" onclick="openDeleteModal()">Excluir Card</button>
        <button type="button" class="btn btn-info" onclick="sortCardsByDate()">Ordenar por Data</button>

    </div>


    <!-- Card -->
    <div class="row mt-3" id="cards-container">
        <div class="col-12 col-md-6 col-lg-3 mb-4 card-wrapper">
            <div class="card" style="height: 100%;">
                <img src="https://cdn.pixabay.com/photo/2024/06/01/14/00/ai-8802304_1280.jpg"
                    class="my-divulgacao_eventos-s1-imagem card-image" alt="Imagem do evento">
                <div class="card-body">
                    <h5 class="card-title">Título</h5>
                    <h6 class="card-subtitle mb-2"><span class="card-date">Dia</span> | <span
                            class="card-time">Horário</span></h6>
                    <h6 class="card-subtitle mb-2 text-muted card-location">Local</h6>
                    <h6 class="card-subtitle mb-2 text-muted card-price">Preço</h6>
                    <p class="card-text text-muted card-description">Descrição</p>
                </div>
                <div class="card-footer d-flex justify-content-between align-items-center">
                    <span class="my-divulgacao_eventos-s1-index">1</span>
                    <button class="my-divulgacao_eventos-s1-btnVerEventos"
                        onclick="window.open('https://www.exemplo3.com', '_blank')">Ver
                        Evento</button>

                </div>
            </div>
        </div>
    </div>

</div>

<!-- Modal para exclusão -->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteModalLabel">Excluir Card</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <input type="number" id="deleteIndex" class="form-control" placeholder="Índice do Card para excluir">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" onclick="deleteCard()">Excluir</button>
            </div>
        </div>
    </div>
</div>


<!-- Modal para edição -->
<div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <!-- Modal Header -->
            <div class="modal-header">
                <h5 class="modal-title" id="editModalLabel">Editar Evento</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <!-- Modal Body -->
            <div class="modal-body">
                <form id="editForm">
                    <!-- Índice -->
                    <div class="input-group mb-3">
                        <span class="input-group-text"><i class="fas fa-list-ol"></i></span>
                        <input type="number" class="form-control form-control-sm" id="editIndex"
                            placeholder="Índice Card">
                    </div>

                    <!-- URL da Imagem -->
                    <div class="input-group mb-3">
                        <span class="input-group-text"><i class="fas fa-image"></i></span>
                        <input type="text" class="form-control form-control-sm" id="editImage"
                            placeholder="URL da Imagem">
                    </div>

                    <!-- Título -->
                    <div class="input-group mb-3">
                        <span class="input-group-text"><i class="fas fa-heading"></i></span>
                        <input type="text" class="form-control form-control-sm" id="editTitle" placeholder="Título">
                    </div>

                    <!-- Data e Horário -->
                    <div class="row mb-3">
                        <div class="col">
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-calendar-alt"></i></span>
                                <input type="date" class="form-control form-control-sm" id="editDate"
                                    placeholder="Data">
                            </div>
                        </div>
                        <div class="col">
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-clock"></i></span>
                                <input type="time" class="form-control form-control-sm" id="editTime"
                                    placeholder="Horário">
                            </div>
                        </div>
                    </div>

                    <!-- Local -->
                    <div class="input-group mb-3">
                        <span class="input-group-text"><i class="fas fa-map-marker-alt"></i></span>
                        <input type="text" class="form-control form-control-sm" id="editLocation" placeholder="Local">
                    </div>

                    <!-- Preço -->
                    <div class="input-group mb-3">
                        <span class="input-group-text"><i class="fas fa-dollar-sign"></i></span>
                        <input type="number" class="form-control form-control-sm" id="editPrice" placeholder="Preço">
                    </div>

                    <!-- Descrição -->
                    <div class="input-group mb-3">
                        <span class="input-group-text"><i class="fas fa-align-left"></i></span>
                        <textarea class="form-control form-control-sm" id="editDescription"
                            placeholder="Descrição"></textarea>
                    </div>

                    <!-- URL -->
                    <div class="input-group mb-3">
                        <span class="input-group-text"><i class="fas fa-link"></i></span>
                        <input type="text" class="form-control form-control-sm" id="editUrl"
                            placeholder="URL da página">
                    </div>
                </form>
            </div>

            <!-- Modal Footer -->
            <div class="modal-footer">
                <button type="button" class="my-divulgacao_eventos-s1-btnSalvarAlterações" id="saveChangesBtn">Salvar
                    alterações</button>
            </div>
        </div>
    </div>
</div>




<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8"
    crossorigin="anonymous"></script>



<!-- Estrutura HTML mantida -->

<script>
    let cardCount = 1; // Variável para contar o número total de cards

    // Função para adicionar um novo card
    function addCard() {
        const cardContainer = document.getElementById('cards-container');
        const newCard = document.createElement('div');
        newCard.classList.add('col-12', 'col-md-6', 'col-lg-3', 'mb-4', 'card-wrapper');

        // Card HTML com o índice correto atualizado
        newCard.innerHTML = `
                <div class="card" style="height: 100%;">
                    <img src="https://cdn.pixabay.com/photo/2024/06/01/14/00/ai-8802304_1280.jpg"
                        class="my-divulgacao_eventos-s1-imagem card-image" alt="Imagem do evento">
                    <div class="card-body">
                        <h5 class="card-title">Título</h5>
                        <h6 class="card-subtitle mb-2"><span class="card-date">Dia</span> | <span
                                class="card-time">Horário</span></h6>
                        <h6 class="card-subtitle mb-2 text-muted card-location">Local</h6>
                        <h6 class="card-subtitle mb-2 text-muted card-price">Preço</h6>
                        <p class="card-text text-muted card-description">Descrição</p>
                    </div>
                    <div class="card-footer d-flex justify-content-between align-items-center">
                        <span class="my-divulgacao_eventos-s1-index">${cardCount}</span> <!-- Índice atualizado -->
                        <button class="my-divulgacao_eventos-s1-btnVerEventos"
                            onclick="window.open('https://www.exemplo3.com', '_blank')">Ver
                            Evento</button>
                    </div>
                </div>
            `;
        cardContainer.appendChild(newCard);
        cardCount++; // Incrementa o contador de cards
        updateCardIndices(); // Atualiza todos os índices após a adição
    }


    // Função para atualizar os índices visíveis nos cards
    function updateCardIndices() {
        const cards = document.querySelectorAll('.card-wrapper'); // Seleciona todos os cards
        cards.forEach((card, index) => {
            card.querySelector('.my-divulgacao_eventos-s1-index').textContent = index + 1;
        });
    }


    // Função para abrir o modal de exclusão
    function openDeleteModal() {
        const deleteModal = new bootstrap.Modal(document.getElementById('deleteModal'));
        deleteModal.show();
    }


    // Função para excluir um card específico pelo índice
    function deleteCard() {
        const indexToDelete = parseInt(document.getElementById('deleteIndex').value, 10) - 1; // Converte o índice 1-based para 0-based
        const cards = document.querySelectorAll('.card-wrapper');

        if (indexToDelete >= 0 && indexToDelete < cards.length) {
            // Remove o card selecionado
            cards[indexToDelete].remove();

            // Decrementa o contador de cards para manter a contagem correta
            cardCount--;

            // Atualiza os índices visíveis dos cards
            updateCardIndices();

            // Fecha o modal de exclusão
            const deleteModal = bootstrap.Modal.getInstance(document.getElementById('deleteModal'));
            deleteModal.hide();
        } else {
            alert('Índice inválido. Por favor, escolha um índice de card válido.');
        }
    }


    // Função para abrir o modal de edição
    function openEditModal() {
        const editModal = new bootstrap.Modal(document.getElementById('editModal'));
        editModal.show();
    }


    document.getElementById('saveChangesBtn').addEventListener('click', function () {
        const index = document.getElementById('editIndex').value - 1; // Índice baseado em 1
        const cards = document.querySelectorAll('.card');

        if (index >= 0 && index < cards.length) {
            const selectedCard = cards[index];

            // Atualiza a imagem, título, local, preço e descrição do card
            const imageUrl = document.getElementById('editImage').value;
            if (imageUrl) {
                selectedCard.querySelector('.card-image').src = imageUrl;
            }
            selectedCard.querySelector('.card-title').innerText = document.getElementById('editTitle').value;
            selectedCard.querySelector('.card-location').innerText = document.getElementById('editLocation').value;
            selectedCard.querySelector('.card-price').innerText = "R$ " + document.getElementById('editPrice').value;
            selectedCard.querySelector('.card-description').innerText = document.getElementById('editDescription').value;

            // Formata e exibe a data e hora
            const dateInput = document.getElementById('editDate').value;
            const timeInput = document.getElementById('editTime').value;
            if (dateInput && timeInput) {
                const formattedDate = formatDate(dateInput); // Formatação da data
                selectedCard.querySelector('.card-date').innerText = formattedDate;
                selectedCard.querySelector('.card-time').innerText = timeInput;
            }

            // Atualiza o link do botão "Ver Evento"
            selectedCard.querySelector('.my-divulgacao_eventos-s1-btnVerEventos').setAttribute(
                'onclick', `window.open('${document.getElementById('editUrl').value}', '_blank')`
            );

            // Fecha o modal
            const editModal = bootstrap.Modal.getInstance(document.getElementById('editModal'));
            editModal.hide();
        } else {
            alert('Índice inválido. Por favor, escolha um índice de card válido.');
        }
    });


    // Função para formatar a data para "dd/mm/yyyy"
    function formatDate(dateStr) {
        const [year, month, day] = dateStr.split('-');
        return `${day}/${month}/${year}`;
    }

    // Função para ordenar os cards por data
    function sortCardsByDate() {
        const cardsContainer = document.getElementById('cards-container');
        const cards = Array.from(cardsContainer.getElementsByClassName('card-wrapper'));

        // Ordena os cards com base na data (formato dd/mm/yyyy)
        cards.sort((a, b) => {
            const dateA = new Date(a.querySelector('.card-date').textContent.split('/').reverse().join('-'));
            const dateB = new Date(b.querySelector('.card-date').textContent.split('/').reverse().join('-'));
            return dateA - dateB;
        });

        // Remove todos os cards e os adiciona na nova ordem
        cardsContainer.innerHTML = '';
        cards.forEach(card => cardsContainer.appendChild(card));

        // Atualiza os índices dos cards após a ordenação
        updateCardIndices();
    }


</script>